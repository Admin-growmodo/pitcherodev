{"version":3,"file":"evx.umd.js","sources":["../index.js"],"sourcesContent":["const isObj = v => typeof v === 'object' && !Array.isArray(v)\n\nconst validate = o => {\n  if (!isObj(o)) throw 'state should be an object'\n}\n\nconst uniq = arr => arr.reduce((a, b, i) => {\n  if (a.indexOf(b) > -1) return a\n  return a.concat(b)\n}, [])\n\nconst fire = (evs, events, state, transient) => uniq(evs)\n  .reduce((fns, ev) => fns.concat(events[ev] || []), [])\n  .map(fn => fn(state, transient))\n\nconst evx = create()\n\nexport const on = evx.on\nexport const emit = evx.emit\nexport const hydrate = evx.hydrate\nexport const getState = evx.getState\n\nexport function create (state = {}) {\n  const events = {}\n\n  return {\n    getState () {\n      return Object.assign({}, state)\n    },\n    hydrate (s) {\n      validate(s)\n\n      Object.assign(state, s)\n\n      return () => {\n        const evs = ['*'].concat(Object.keys(s))\n        fire(evs, events, state)\n      }\n    },\n    on (evs, fn) {\n      evs = [].concat(evs)\n      evs.map(ev => events[ev] = (events[ev] || []).concat(fn))\n      return () => evs.map(\n        ev => events[ev].splice(events[ev].indexOf(fn), 1)\n      )\n    },\n    emit (ev, data, transient) {\n      let evs = (ev === '*' ? [] : ['*']).concat(ev)\n\n      data = typeof data === 'function' ? data(state) : data\n\n      if (data) {\n        validate(data)\n        Object.assign(state, data)\n        evs = evs.concat(Object.keys(data))\n      }\n\n      fire(evs, events, state, transient)\n    }\n  }\n}\n"],"names":["const","validate","o","v","Array","isArray","fire","evs","events","state","transient","arr","reduce","a","b","i","indexOf","concat","fns","ev","map","fn","evx","create","emit","hydrate","getState","Object","assign","s","keys","on","splice","data"],"mappings":"yKAAAA,IAEMC,WAAWC,MAFe,iBAAlBC,EAGDD,IAHgCE,MAAMC,QAAQF,GAG1C,KAAM,gCAHTA,GAWRG,WAAQC,EAAKC,EAAQC,EAAOC,UALrBC,EAKwCJ,EALjCI,EAAIC,gBAAQC,EAAGC,EAAGC,UAChCF,EAAEG,QAAQF,IAAM,EAAUD,EACvBA,EAAEI,OAAOH,IACf,KAGAF,gBAAQM,EAAKC,UAAOD,EAAID,OAAOT,EAAOW,IAAO,KAAK,IAClDC,aAAIC,UAAMA,EAAGZ,EAAOC,SAPVC,GASPW,EAAMC,IAGCC,EAAOF,EAAIE,KACXC,EAAUH,EAAIG,QACdC,EAAWJ,EAAII,SAErB,SAASH,EAAQd,kBAAQ,QACxBD,EAAS,SAER,CACLkB,2BACSC,OAAOC,OAAO,GAAInB,IAE3BgB,iBAASI,UACP5B,EAAS4B,GAETF,OAAOC,OAAOnB,EAAOoB,kBAGbtB,EAAM,CAAC,KAAKU,OAAOU,OAAOG,KAAKD,IACrCvB,EAAKC,EAAKC,EAAQC,KAGtBsB,YAAIxB,EAAKc,UACPd,EAAM,GAAGU,OAAOV,IACZa,aAAID,UAAMX,EAAOW,IAAOX,EAAOW,IAAO,IAAIF,OAAOI,uBACxCd,EAAIa,aACfD,UAAMX,EAAOW,GAAIa,OAAOxB,EAAOW,GAAIH,QAAQK,GAAK,OAGpDG,cAAML,EAAIc,EAAMvB,OACVH,GAAc,MAAPY,EAAa,GAAK,CAAC,MAAMF,OAAOE,IAE3Cc,EAAuB,mBAATA,EAAsBA,EAAKxB,GAASwB,KAGhDhC,EAASgC,GACTN,OAAOC,OAAOnB,EAAOwB,GACrB1B,EAAMA,EAAIU,OAAOU,OAAOG,KAAKG,KAG/B3B,EAAKC,EAAKC,EAAQC,EAAOC,UAxCbY,EAAIS"}