!function(n,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t(n.picoapp={})}(this,function(n){var t=function(n){if("object"!=typeof(t=n)||Array.isArray(t))throw"state should be an object";var t},e=function(n,t,e,o){return(r=n,r.reduce(function(n,t,e){return n.indexOf(t)>-1?n:n.concat(t)},[])).reduce(function(n,e){return n.concat(t[e]||[])},[]).map(function(n){return n(e,o)});var r};function o(n){void 0===n&&(n={});var o={};return{getState:function(){return Object.assign({},n)},hydrate:function(r){return t(r),Object.assign(n,r),function(){var t=["*"].concat(Object.keys(r));e(t,o,n)}},on:function(n,t){return(n=[].concat(n)).map(function(n){return o[n]=(o[n]||[]).concat(t)}),function(){return n.map(function(n){return o[n].splice(o[n].indexOf(t),1)})}},emit:function(r,u,c){var i=("*"===r?[]:["*"]).concat(r);(u="function"==typeof u?u(n):u)&&(t(u),Object.assign(n,u),i=i.concat(Object.keys(u))),e(i,o,n,c)}}}o();var r=function(n){return"object"==typeof n&&!Array.isArray(n)},u=function(n){return"function"==typeof n};n.component=function(n){return function(t,e){var o=[];return{subs:o,unmount:n(t,Object.assign({},e,{on:function(n,t){var r=e.on(n,t);return o.push(r),r}})),node:t}}},n.picoapp=function(n,t,e){void 0===n&&(n={}),void 0===t&&(t={}),void 0===e&&(e=[]);var c=o(t),i=[];return{on:c.on,emit:c.emit,getState:function(){return c.getState()},add:function(t){if(!r(t))throw"components should be an object";Object.assign(n,t)},use:function(n){if(!u(n))throw"plugins should be a function";e.push(n)},hydrate:function(n){return c.hydrate(n)},mount:function(t){void 0===t&&(t="data-component"),t=[].concat(t);for(var o=0;o<t.length;o++){for(var a=t[o],f=[].slice.call(document.querySelectorAll("["+a+"]")),s=function(){for(var t=f.pop(),o=t.getAttribute(a).split(/\s/),s=0;s<o.length;s++){var p=n[o[s]];if(p){t.removeAttribute(a);try{var d=e.reduce(function(n,e){var o=e(t,c);return r(o)?Object.assign(n,o):n},{}),v=p(t,Object.assign({},d,c));u(v.unmount)&&i.push(v)}catch(n){console.error(n),c.emit("error",{error:n}),c.hydrate({error:void 0})}}}};f.length;)s();c.emit("mount")}},unmount:function(){for(var n=i.length-1;n>-1;n--){var t=i[n],e=t.subs;(0,t.unmount)(t.node),e.map(function(n){return n()}),i.splice(n,1)}c.emit("unmount")}}}});
//# sourceMappingURL=picoapp.umd.js.map
